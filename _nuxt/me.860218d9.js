import{u as O,a as X,_ as me}from"./useLogout.c9853dd7.js";import{q as _e,N as fe,r as G,u as K,c as Y,e as Q,_ as pe}from"./index.7d41ccd9.js";import{f as j,h as ee,r as z,k as w,s as he,z as V,C as Z,o as f,g as v,w as i,a as H,A as l,b as _,d as E,B as re,c as F,t as U,E as ge,K as ve,O as be,F as Ce,D as xe,u as we}from"./entry.177f79c7.js";import{_ as te,b as ne}from"./text.273f0f83.js";import{_ as ye,u as ke,a as Ee,b as ze}from"./useMyEnroll.d90d13d9.js";import{b as se,c as ae,_ as $e,d as Ie}from"./Spin.edffac75.js";import{_ as le}from"./nuxt-link.9fd3bcf3.js";import{_ as Re}from"./team.vue.b481a29d.js";import{c as Be,_ as Se}from"./drawer-or-modal.vue.6b5a9516.js";import{q as Le,v as L,w as T,e as M,f as $,h as oe,g as Te,u as Pe,j as ie,l as Ae,x as R,k as We,y as He,n as Fe,z as Ne,N as Me,_ as ce}from"./Button.4a356657.js";import{o as Ue}from"./ready.c5065cc9.js";import{f as Ve}from"./useNarrowScreen.3f20cede.js";import{E as je,W as qe,I as Oe,S as Ge}from"./light.c90078c7.js";import{_ as Ke}from"./Result.3f62e3c0.js";import"./Modal.caf2e457.js";import"./_createCompounder.d8917e73.js";const De=u=>{const{lineHeight:e,borderRadius:s,fontWeightStrong:r,baseColor:o,dividerColor:d,actionColor:m,textColor1:h,textColor2:a,closeColorHover:b,closeColorPressed:x,closeIconColor:y,closeIconColorHover:C,closeIconColorPressed:g,infoColor:n,successColor:t,warningColor:c,errorColor:p,fontSize:k}=u;return Object.assign(Object.assign({},Be),{fontSize:k,lineHeight:e,titleFontWeight:r,borderRadius:s,border:`1px solid ${d}`,color:m,titleTextColor:h,iconColor:a,contentTextColor:a,closeBorderRadius:s,closeColorHover:b,closeColorPressed:x,closeIconColor:y,closeIconColorHover:C,closeIconColorPressed:g,borderInfo:`1px solid ${L(o,T(n,{alpha:.25}))}`,colorInfo:L(o,T(n,{alpha:.08})),titleTextColorInfo:h,iconColorInfo:n,contentTextColorInfo:a,closeColorHoverInfo:b,closeColorPressedInfo:x,closeIconColorInfo:y,closeIconColorHoverInfo:C,closeIconColorPressedInfo:g,borderSuccess:`1px solid ${L(o,T(t,{alpha:.25}))}`,colorSuccess:L(o,T(t,{alpha:.08})),titleTextColorSuccess:h,iconColorSuccess:t,contentTextColorSuccess:a,closeColorHoverSuccess:b,closeColorPressedSuccess:x,closeIconColorSuccess:y,closeIconColorHoverSuccess:C,closeIconColorPressedSuccess:g,borderWarning:`1px solid ${L(o,T(c,{alpha:.33}))}`,colorWarning:L(o,T(c,{alpha:.08})),titleTextColorWarning:h,iconColorWarning:c,contentTextColorWarning:a,closeColorHoverWarning:b,closeColorPressedWarning:x,closeIconColorWarning:y,closeIconColorHoverWarning:C,closeIconColorPressedWarning:g,borderError:`1px solid ${L(o,T(p,{alpha:.25}))}`,colorError:L(o,T(p,{alpha:.08})),titleTextColorError:h,iconColorError:p,contentTextColorError:a,closeColorHoverError:b,closeColorPressedError:x,closeIconColorError:y,closeIconColorHoverError:C,closeIconColorPressedError:g})},Je={name:"Alert",common:Le,self:De},Xe=Je,Ye=M("alert",`
 line-height: var(--n-line-height);
 border-radius: var(--n-border-radius);
 position: relative;
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-color);
 text-align: start;
 word-break: break-word;
`,[$("border",`
 border-radius: inherit;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 transition: border-color .3s var(--n-bezier);
 border: var(--n-border);
 pointer-events: none;
 `),oe("closable",[M("alert-body",[$("title",`
 padding-right: 24px;
 `)])]),$("icon",{color:"var(--n-icon-color)"}),M("alert-body",{padding:"var(--n-padding)"},[$("title",{color:"var(--n-title-text-color)"}),$("content",{color:"var(--n-content-text-color)"})]),Ve({originalTransition:"transform .3s var(--n-bezier)",enterToProps:{transform:"scale(1)"},leaveToProps:{transform:"scale(0.9)"}}),$("icon",`
 position: absolute;
 left: 0;
 top: 0;
 align-items: center;
 justify-content: center;
 display: flex;
 width: var(--n-icon-size);
 height: var(--n-icon-size);
 font-size: var(--n-icon-size);
 margin: var(--n-icon-margin);
 `),$("close",`
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 position: absolute;
 right: 0;
 top: 0;
 margin: var(--n-close-margin);
 `),oe("show-icon",[M("alert-body",{paddingLeft:"calc(var(--n-icon-margin-left) + var(--n-icon-size) + var(--n-icon-margin-right))"})]),M("alert-body",`
 border-radius: var(--n-border-radius);
 transition: border-color .3s var(--n-bezier);
 `,[$("title",`
 transition: color .3s var(--n-bezier);
 font-size: 16px;
 line-height: 19px;
 font-weight: var(--n-title-font-weight);
 `,[Te("& +",[$("content",{marginTop:"9px"})])]),$("content",{transition:"color .3s var(--n-bezier)",fontSize:"var(--n-font-size)"})]),$("icon",{transition:"color .3s var(--n-bezier)"})]),Qe=Object.assign(Object.assign({},ie.props),{title:String,showIcon:{type:Boolean,default:!0},type:{type:String,default:"default"},bordered:{type:Boolean,default:!0},closable:Boolean,onClose:Function,onAfterLeave:Function,onAfterHide:Function}),Ze=j({name:"Alert",inheritAttrs:!1,props:Qe,setup(u){const{mergedClsPrefixRef:e,mergedBorderedRef:s,inlineThemeDisabled:r,mergedRtlRef:o}=Pe(u),d=ie("Alert","-alert",Ye,Xe,u,e),m=Ae("Alert",o,e),h=ee(()=>{const{common:{cubicBezierEaseInOut:g},self:n}=d.value,{fontSize:t,borderRadius:c,titleFontWeight:p,lineHeight:k,iconSize:B,iconMargin:S,iconMarginRtl:P,closeIconSize:A,closeBorderRadius:N,closeSize:D,closeMargin:q,closeMarginRtl:J,padding:W}=n,{type:I}=u,{left:ue,right:de}=_e(S);return{"--n-bezier":g,"--n-color":n[R("color",I)],"--n-close-icon-size":A,"--n-close-border-radius":N,"--n-close-color-hover":n[R("closeColorHover",I)],"--n-close-color-pressed":n[R("closeColorPressed",I)],"--n-close-icon-color":n[R("closeIconColor",I)],"--n-close-icon-color-hover":n[R("closeIconColorHover",I)],"--n-close-icon-color-pressed":n[R("closeIconColorPressed",I)],"--n-icon-color":n[R("iconColor",I)],"--n-border":n[R("border",I)],"--n-title-text-color":n[R("titleTextColor",I)],"--n-content-text-color":n[R("contentTextColor",I)],"--n-line-height":k,"--n-border-radius":c,"--n-font-size":t,"--n-title-font-weight":p,"--n-icon-size":B,"--n-icon-margin":S,"--n-icon-margin-rtl":P,"--n-close-size":D,"--n-close-margin":q,"--n-close-margin-rtl":J,"--n-padding":W,"--n-icon-margin-left":ue,"--n-icon-margin-right":de}}),a=r?We("alert",ee(()=>u.type[0]),h,u):void 0,b=z(!0),x=()=>{const{onAfterLeave:g,onAfterHide:n}=u;g&&g(),n&&n()};return{rtlEnabled:m,mergedClsPrefix:e,mergedBordered:s,visible:b,handleCloseClick:()=>{var g;Promise.resolve((g=u.onClose)===null||g===void 0?void 0:g.call(u)).then(n=>{n!==!1&&(b.value=!1)})},handleAfterLeave:()=>{x()},mergedTheme:d,cssVars:r?void 0:h,themeClass:a==null?void 0:a.themeClass,onRender:a==null?void 0:a.onRender}},render(){var u;return(u=this.onRender)===null||u===void 0||u.call(this),w(Me,{onAfterLeave:this.handleAfterLeave},{default:()=>{const{mergedClsPrefix:e,$slots:s}=this,r={class:[`${e}-alert`,this.themeClass,this.closable&&`${e}-alert--closable`,this.showIcon&&`${e}-alert--show-icon`,this.rtlEnabled&&`${e}-alert--rtl`],style:this.cssVars,role:"alert"};return this.visible?w("div",Object.assign({},he(this.$attrs,r)),this.closable&&w(fe,{clsPrefix:e,class:`${e}-alert__close`,onClick:this.handleCloseClick}),this.bordered&&w("div",{class:`${e}-alert__border`}),this.showIcon&&w("div",{class:`${e}-alert__icon`,"aria-hidden":"true"},He(s.icon,()=>[w(Fe,{clsPrefix:e},{default:()=>{switch(this.type){case"success":return w(Ge,null);case"info":return w(Oe,null);case"warning":return w(qe,null);case"error":return w(je,null);default:return null}}})])),w("div",{class:[`${e}-alert-body`,this.mergedBordered&&`${e}-alert-body--bordered`]},Ne(s.header,o=>{const d=o||this.title;return d?w("div",{class:`${e}-alert-body__title`},d):null}),s.default&&w("div",{class:`${e}-alert-body__content`},s))):null}})}}),eo=async u=>{var o;const e=G("token",null).value;if(!e)throw Error("未登录");const{data:s,error:r}=await K("/setimg",{baseURL:"https://124.223.35.239/api/v1",body:JSON.stringify(u),headers:{authorization:`Bearer ${e}`},method:"post"},"$uLuKV08PGY");if(!r.value)return s;throw r.value.statusCode===401?(O(),Error("登录过期，请重新登录")):r.value.statusCode===500?Error("服务端错误，请联系网站管理员"):Error(((o=r.value.data)==null?void 0:o.message)??"未知错误，请联系网站管理员")},oo=async u=>{var o;const e=G("token",null).value;if(!e)throw Error("未登录");const{data:s,error:r}=await K("/user/name",{baseURL:"https://124.223.35.239/api/v1",headers:{authorization:`Bearer ${e}`},method:"post",params:{newchinaname:u}},"$XqYTvbX6hx");if(!r.value)return s;throw r.value.statusCode===401?(O(),Error("登录过期，请重新登录")):r.value.statusCode===500?Error("服务端错误，请联系网站管理员"):Error(((o=r.value.data)==null?void 0:o.message)??"未知错误，请联系网站管理员")},ro={flex:"","flex-col":"","items-center":"","gap-4":"","lg:flex-row":""},to=H("br",null,null,-1),no={"h-full":"",flex:"","flex-col":"","items-center":"","gap-4":"","lg:items-start":""},so={flex:"","items-center":"","gap-4":""},ao={key:2,"text-xl":"","font-bold":""},lo={flex:"","items-center":"","gap-2":""},io={key:1,"text-xs":"","text-slate-500":""},co=j({__name:"info",setup(u){const e=V([]),s=z(!1),r=z(!1),o=z(""),d=z(null),{me:m,update:h}=X(),a=Y(),b=z(!1);Z(m,()=>{const t=m.value;o.value=(t==null?void 0:t.chinaname)??"",t!=null&&t.base64&&(e.splice(0),e.push({id:"current",name:"头像",status:"finished",url:t.base64}))},{immediate:!0});const y=t=>{const{file:c}=t.file;return c?c.size>10**6?(a.error("图片文件大小不能大于1MB"),!1):!0:!1},C=({file:t})=>{if(!t.file)return;b.value=!0;const c=new FileReader;c.readAsDataURL(t.file),c.addEventListener("load",async p=>{var B;const k=(B=p.target)==null?void 0:B.result;if(typeof k=="string"){try{await eo(k),h(),a.success("上传成功")}catch(S){S instanceof Error&&a.error(S.message)}b.value=!1}})},g=async()=>{var t,c;if(o.value||(a.error("昵称不能为空"),o.value=((t=m.value)==null?void 0:t.chinaname)??""),o.value!==((c=m.value)==null?void 0:c.chinaname)){s.value=!0;try{await oo(o.value),await h(),a.success("修改成功")}catch(p){p instanceof Error&&a.error(p.message)}}s.value=!1,r.value=!1},n=async()=>{var t;r.value=!0,await ve(),(t=d.value)==null||t.focus()};return(t,c)=>{const p=te,k=ye,B=se,S=ae,P=me,A=Q;return f(),v(A,{style:{width:"calc(100vw - 2rem)"},"max-w-768px":""},{default:i(()=>[H("div",ro,[l(m)?(f(),v(B,{key:1,show:l(b)},{default:i(()=>[_(k,{"default-file-list":l(e),accept:"image/*",max:1,color:"#8590a6","list-type":"image-card","w-24":"","custom-request":C,onBeforeUpload:y},{default:i(()=>[E(" 点击上传"),to,E("用户头像 ")]),_:1},8,["default-file-list"])]),_:1},8,["show"])):(f(),v(p,{key:0,"h-24":"","w-24":"",sharp:!1})),H("div",no,[H("div",so,[l(m)?l(r)?(f(),v(S,{key:1,ref_key:"nameInputRef",ref:d,value:l(o),"onUpdate:value":c[0]||(c[0]=N=>re(o)?o.value=N:null),size:"small",placeholder:"请输入新昵称",loading:l(s),onBlur:g},null,8,["value","loading"])):(f(),F("div",ao,U(l(m).chinaname),1)):(f(),v(p,{key:0,text:"","h-28px":"","w-20":""})),l(r)?ge("",!0):(f(),F("div",{key:3,"i-material-symbols-edit":"","cursor-pointer":"","text-slate-400":"",onClick:n}))]),H("div",lo,[l(m)?(f(),v(P,{key:1,size:"small",bordered:!1,type:"info"},{default:i(()=>[E(" @"+U(l(m).name),1)]),_:1})):(f(),v(p,{key:0,text:"","h-22px":"","w-20":""})),l(m)?(f(),v(P,{key:3,size:"small",bordered:!1,type:"success"},{default:i(()=>[E(" #"+U(l(m).id),1)]),_:1})):(f(),v(p,{key:2,text:"","h-22px":"","w-10":""}))]),l(m)?(f(),F("div",io,U(l(m).email),1)):(f(),v(p,{key:0,text:"","h-4":"","w-30":""}))])])]),_:1})}}}),uo=async(u,e)=>{var d;const s=G("token",null).value;if(!s)throw Error("未登录");const{data:r,error:o}=await K("/user/form",{baseURL:"https://124.223.35.239/api/v1",headers:{authorization:`Bearer ${s}`},method:"post",params:{formname:u,formpassword:e}},"$l6xArG38qW");if(!o.value)return r;throw o.value.statusCode===401?(O(),Error("登录过期，请重新登录")):o.value.statusCode===500?Error("服务端错误，请联系网站管理员"):Error(((d=o.value.data)==null?void 0:d.message)??"未知错误，请联系网站管理员")},mo={flex:"","gap-4":""},_o=j({__name:"team",setup(u){const e=Y(),s=z(!0),r=V({logo:"",members:[],name:"",password:"",time:"",vote:0}),o=V({name:[{message:"请输入战队名称",required:!0,trigger:"blur"},{message:"该名称不存在",trigger:"blur",validator(n,t){return new Promise((c,p)=>{if(!t){c();return}ke(t).then(k=>{k.value?c():p(Error())}).catch(()=>{Ee()})})}}],password:{message:"请输入战队密码",required:!0,trigger:"blur"}}),d=z(!1),m=z(!1),h=z(null),a=V({name:"",password:""}),b=async()=>{try{const n=await ze();r.logo=n.value.logo_uri,r.members.splice(0),r.members.push(...n.value.role.map(t=>({camp:t.role_lin==="求生者",name:t.role_name}))),r.name=n.value.team_name,r.password=n.value.team_password,r.time=new Date(n.value.time).toLocaleString(),r.vote=n.value.piaoshu}catch(n){n instanceof Error&&e.error(n.message)}},x=()=>{d.value=!0},y=()=>{d.value=!1},C=()=>{var n;m.value=!0,(n=h.value)==null||n.validate(async t=>{if(t){e.error("表单存在错误"),m.value=!1;return}try{await uo(a.name,a.password),d.value=!1,await b(),e.success("绑定成功")}catch(c){c instanceof Error&&e.error(c.message)}m.value=!1})},{me:g}=X();return Z(g,async()=>{g.value&&(await b(),s.value=!1)},{immediate:!0}),(n,t)=>{const c=ce,p=le,k=pe,B=Re,S=ne,P=ae,A=$e,N=Ie,D=se,q=Q,J=Se;return f(),v(q,{title:"我的战队",style:{width:"calc(100vw - 2rem)"},"max-w-768px":""},be({default:i(()=>[l(s)?(f(),v(B,{key:0})):l(r).name?(f(),v(B,{key:1,team:l(r)},null,8,["team"])):(f(),v(S,{key:2,description:"你没有参与过报名"},{extra:i(()=>[H("div",mo,[_(p,{to:"/enroll"},{default:i(()=>[_(c,{size:"small",type:"primary"},{default:i(()=>[E(" 前往报名 ")]),_:1})]),_:1}),_(c,{size:"small",onClick:x},{default:i(()=>[E(" 绑定战队 ")]),_:1})])]),_:1})),_(J,{isVisible:l(d),"onUpdate:isVisible":t[2]||(t[2]=W=>re(d)?d.value=W:null),"drawer-height":290},{default:i(()=>[_(q,{title:"绑定战队",closable:"",onClose:y},{default:i(()=>[_(D,{show:l(m)},{description:i(()=>[E(" 加载中…… ")]),default:i(()=>[_(N,{ref_key:"bindingEnrollFormRef",ref:h,model:l(a),rules:l(o),"show-label":!1,size:"large"},{default:i(()=>[_(A,{path:"name"},{default:i(()=>[_(P,{value:l(a).name,"onUpdate:value":t[0]||(t[0]=W=>l(a).name=W),placeholder:"请输入战队名称",clearable:""},null,8,["value"])]),_:1}),_(A,{path:"password"},{default:i(()=>[_(P,{value:l(a).password,"onUpdate:value":t[1]||(t[1]=W=>l(a).password=W),type:"password",placeholder:"请输入战队密码","show-password-on":"click",clearable:""},null,8,["value"])]),_:1}),_(A,null,{default:i(()=>[_(c,{type:"primary","w-full":"",onClick:C},{default:i(()=>[E(" 提交 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["show"])]),_:1})]),_:1},8,["isVisible"])]),_:2},[l(r).name?{name:"header-extra",fn:i(()=>[_(p,{to:"/enroll?type=modification"},{default:i(()=>[_(c,{size:"small",tertiary:""},{default:i(()=>[E(" 编辑 ")]),_:1})]),_:1}),_(k,{vertical:""}),_(c,{size:"small",tertiary:"",onClick:x},{default:i(()=>[E(" 换绑 ")]),_:1})]),key:"0"}:void 0]),1024)}}}),fo=async()=>{var r;const u=G("token",null).value;if(!u)throw Error("未登录");const{data:e,error:s}=await K("/game/mylog",{baseURL:"https://124.223.35.239/api/v1",headers:{authorization:`Bearer ${u}`}},"$J8Wu7smPxV");if(!s.value)return e;throw s.value.statusCode===401?(O(),Error("登录过期，请重新登录")):s.value.statusCode===500?Error("服务端错误，请联系网站管理员"):Error(((r=s.value.data)==null?void 0:r.message)??"未知错误，请联系网站管理员")},po={key:2,flex:"","flex-col":"","gap-4":""},ho=j({__name:"guess",setup(u){const e=z(!0),s=V([]),r=Y();return Ue(async()=>{try{const o=await fo();s.push(...o.value.map(d=>({id:d.id,isWinner:d.win,teamName:d.chickteam})))}catch(o){o instanceof Error&&r.error(o.message)}e.value=!1}),(o,d)=>{const m=te,h=Ze,a=ce,b=le,x=ne,y=Q;return f(),v(y,{title:"我的竞猜",style:{width:"calc(100vw - 2rem)"},"max-w-768px":""},{default:i(()=>[l(e)?(f(),v(h,{key:0},{header:i(()=>[_(m,{text:"","h-19px":"","w-20":""})]),default:i(()=>[_(m,{text:"","h-22px":"","w-40":""})]),_:1})):l(s).length===0?(f(),v(x,{key:1,description:"你没有参与过竞猜"},{extra:i(()=>[_(b,{to:"/schedule"},{default:i(()=>[_(a,{size:"small",type:"primary"},{default:i(()=>[E(" 前往竞猜 ")]),_:1})]),_:1})]),_:1})):(f(),F("div",po,[(f(!0),F(Ce,null,xe(l(s),C=>(f(),v(h,{key:C.id,title:C.isWinner?"预测正确":"预测错误",type:C.isWinner?"success":"error"},{default:i(()=>[E(U(C.teamName+(C.isWinner?"获胜":"战败")),1)]),_:2},1032,["title","type"]))),128))]))]),_:1})}}}),go={key:1,"my-4":"",flex:"","flex-col":"","gap-4":""},Po=j({__name:"me",setup(u){we({title:"个人中心 丨 ASG 第五人格赛事"});const e=z(!0),{me:s}=X();return Z(s,()=>{e.value=!1},{immediate:!0}),(r,o)=>{const d=Ke,m=co,h=_o,a=ho;return!l(s)&&!l(e)?(f(),v(d,{key:0,status:"warning",title:"未登录",description:"在查看个人信息前请先登录",style:{"min-height":"calc(100vh - 50px - 60px)"},flex:"","flex-col":"","justify-center":"",size:"huge"})):(f(),F("div",go,[_(m),_(h),_(a)]))}}});export{Po as default};
