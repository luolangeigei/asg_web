import{_ as fe}from"./recaptcha.vue.90d949d5.js";import{f as ee,r as p,k as te,h as j,y as re,m as me,B as ve,i as he,j as $,u as _e,E as pe,G as b,c as H,g as B,J as G,b as x,a as f,w as _,F as X,L as J,I as ge,o as y,t as V,d as O,z as be,v as xe}from"./entry.654799d4.js";import{u as ye}from"./useMe.d3dc7725.js";import{V as we,l as ze,e as ke,b as ae,c as Ce,d as Re,_ as Ee}from"./index.a2bbb1cd.js";import{i as q,o as $e,u as Se}from"./useUnknownError.66cc1a02.js";import{a as Le,t as Te,_ as Be}from"./light.ecb816f1.js";import{t as je,_ as Fe}from"./Tag.efd73fd5.js";import{c as Pe,g as Q,H as Ve,f as Y,I as Oe,q as oe,u as se,b as U,m as le,j as ie,J as Ie,n as Me,E as He,l as W,_ as Ne}from"./Button.e51b7885.js";import{_ as Ae}from"./Spin.ac314ce2.js";import{_ as De,a as Ge}from"./Skeleton.47aec623.js";import{_ as We}from"./Empty.d7d97011.js";import{_ as Ue}from"./Result.3212af42.js";import"./ready.59610ba0.js";import"./index.cd32510b.js";import"./asyncData.8dcfa15e.js";import"./index.40088bab.js";import"./light.3b22fb76.js";import"./fade-in-scale-up.cssr.516586af.js";import"./_common.991711fd.js";import"./light.5c9f1765.js";const Ke=Pe("n-avatar-group"),Xe=Q("avatar",`
 width: var(--n-merged-size);
 height: var(--n-merged-size);
 color: #FFF;
 font-size: var(--n-font-size);
 display: inline-flex;
 position: relative;
 overflow: hidden;
 text-align: center;
 border: var(--n-border);
 border-radius: var(--n-border-radius);
 --n-merged-color: var(--n-color);
 background-color: var(--n-merged-color);
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[Ve(Y("&","--n-merged-color: var(--n-color-modal);")),Oe(Y("&","--n-merged-color: var(--n-color-popover);")),Y("img",`
 width: 100%;
 height: 100%;
 `),oe("text",`
 white-space: nowrap;
 display: inline-block;
 position: absolute;
 left: 50%;
 top: 50%;
 `),Q("icon",`
 vertical-align: bottom;
 font-size: calc(var(--n-merged-size) - 6px);
 `),oe("text","line-height: 1.25")]),Je=Object.assign(Object.assign({},U.props),{size:[String,Number],src:String,circle:{type:Boolean,default:void 0},objectFit:String,round:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},onError:Function,fallbackSrc:String,intersectionObserverOptions:Object,lazy:Boolean,onLoad:Function,renderPlaceholder:Function,renderFallback:Function,imgProps:Object,color:String}),qe=ee({name:"Avatar",props:Je,setup(o){const{mergedClsPrefixRef:i,inlineThemeDisabled:c}=se(o),r=p(!1);let l=null;const n=p(null),d=p(null),m=()=>{const{value:t}=n;if(t&&(l===null||l!==t.innerHTML)){l=t.innerHTML;const{value:e}=d;if(e){const{offsetWidth:s,offsetHeight:a}=e,{offsetWidth:h,offsetHeight:L}=t,P=.9,T=Math.min(s/h*P,a/L*P,1);t.style.transform=`translateX(-50%) translateY(-50%) scale(${T})`}}},u=te(Ke,null),w=j(()=>{const{size:t}=o;if(t)return t;const{size:e}=u||{};return e||"medium"}),S=U("Avatar","-avatar",Xe,Le,o,i),v=te(je,null),g=j(()=>{if(u)return!0;const{round:t,circle:e}=o;return t!==void 0||e!==void 0?t||e:v?v.roundRef.value:!1}),E=j(()=>u?!0:o.bordered||!1),z=t=>{var e;if(!I.value)return;r.value=!0;const{onError:s,imgProps:a}=o;(e=a==null?void 0:a.onError)===null||e===void 0||e.call(a,t),s&&s(t)};re(()=>o.src,()=>r.value=!1);const F=j(()=>{const t=w.value,e=g.value,s=E.value,{color:a}=o,{self:{borderRadius:h,fontSize:L,color:P,border:T,colorModal:A,colorPopover:D},common:{cubicBezierEaseInOut:K}}=S.value;let M;return typeof t=="number"?M=`${t}px`:M=S.value.self[le("height",t)],{"--n-font-size":L,"--n-border":s?T:"none","--n-border-radius":e?"50%":h,"--n-color":a||P,"--n-color-modal":a||A,"--n-color-popover":a||D,"--n-bezier":K,"--n-merged-size":`var(--n-avatar-size-override, ${M})`}}),k=c?ie("avatar",j(()=>{const t=w.value,e=g.value,s=E.value,{color:a}=o;let h="";return t&&(typeof t=="number"?h+=`a${t}`:h+=t[0]),e&&(h+="b"),s&&(h+="c"),a&&(h+=Ie(a)),h}),F,o):void 0,I=p(!o.lazy);me(()=>{if(q)return;let t;const e=ve(()=>{t==null||t(),t=void 0,o.lazy&&(t=$e(d.value,o.intersectionObserverOptions,I))});he(()=>{e(),t==null||t()})});const N=p(!o.lazy);return{textRef:n,selfRef:d,mergedRoundRef:g,mergedClsPrefix:i,fitTextTransform:m,cssVars:c?void 0:F,themeClass:k==null?void 0:k.themeClass,onRender:k==null?void 0:k.onRender,hasLoadError:r,handleError:z,shouldStartLoading:I,loaded:N,mergedOnLoad:t=>{var e;const{onLoad:s,imgProps:a}=o;s==null||s(t),(e=a==null?void 0:a.onLoad)===null||e===void 0||e.call(a,t),N.value=!0}}},render(){var o,i;const{$slots:c,src:r,mergedClsPrefix:l,lazy:n,onRender:d,mergedOnLoad:m,shouldStartLoading:u,loaded:w,hasLoadError:S}=this;d==null||d();let v;const g=!w&&!S&&(this.renderPlaceholder?this.renderPlaceholder():(i=(o=this.$slots).placeholder)===null||i===void 0?void 0:i.call(o));return this.hasLoadError?v=this.renderFallback?this.renderFallback():Me(c.fallback,()=>[$("img",{src:this.fallbackSrc,style:{objectFit:this.objectFit}})]):v=He(c.default,E=>{if(E)return $(we,{onResize:this.fitTextTransform},{default:()=>$("span",{ref:"textRef",class:`${l}-avatar__text`},E)});if(r){const{imgProps:z}=this;return $("img",Object.assign(Object.assign({},z),{loading:q&&!this.intersectionObserverOptions&&n?"lazy":"eager",src:q||u||w?r:void 0,onLoad:m,"data-image-src":r,onError:this.handleError,style:[z==null?void 0:z.style,{objectFit:this.objectFit},g?{height:"0",width:"0",visibility:"hidden",position:"absolute"}:""]}))}}),$("span",{ref:"selfRef",class:[`${l}-avatar`,this.themeClass],style:this.cssVars},v,n&&g)}}),Ye=Q("text",`
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
`,[W("strong",`
 font-weight: var(--n-font-weight-strong);
 `),W("italic",{fontStyle:"italic"}),W("underline",{textDecoration:"underline"}),W("code",`
 line-height: 1.4;
 display: inline-block;
 font-family: var(--n-font-famliy-mono);
 transition: 
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 box-sizing: border-box;
 padding: .05em .35em 0 .35em;
 border-radius: var(--n-code-border-radius);
 font-size: .9em;
 color: var(--n-code-text-color);
 background-color: var(--n-code-color);
 border: var(--n-code-border);
 `)]),Ze=Object.assign(Object.assign({},U.props),{code:Boolean,type:{type:String,default:"default"},delete:Boolean,strong:Boolean,italic:Boolean,underline:Boolean,depth:[String,Number],tag:String,as:{type:String,validator:()=>!0,default:void 0}}),Qe=ee({name:"Text",props:Ze,setup(o){const{mergedClsPrefixRef:i,inlineThemeDisabled:c}=se(o),r=U("Typography","-text",Ye,Te,o,i),l=j(()=>{const{depth:d,type:m}=o,u=m==="default"?d===void 0?"textColor":`textColor${d}Depth`:le("textColor",m),{common:{fontWeightStrong:w,fontFamilyMono:S,cubicBezierEaseInOut:v},self:{codeTextColor:g,codeBorderRadius:E,codeColor:z,codeBorder:F,[u]:k}}=r.value;return{"--n-bezier":v,"--n-text-color":k,"--n-font-weight-strong":w,"--n-font-famliy-mono":S,"--n-code-border-radius":E,"--n-code-text-color":g,"--n-code-color":z,"--n-code-border":F}}),n=c?ie("text",j(()=>`${o.type[0]}${o.depth||""}`),l,o):void 0;return{mergedClsPrefix:i,compitableTag:ze(o,["as","tag"]),cssVars:c?void 0:l,themeClass:n==null?void 0:n.themeClass,onRender:n==null?void 0:n.onRender}},render(){var o,i,c;const{mergedClsPrefix:r}=this;(o=this.onRender)===null||o===void 0||o.call(this);const l=[`${r}-text`,this.themeClass,{[`${r}-text--code`]:this.code,[`${r}-text--delete`]:this.delete,[`${r}-text--strong`]:this.strong,[`${r}-text--italic`]:this.italic,[`${r}-text--underline`]:this.underline}],n=(c=(i=this.$slots).default)===null||c===void 0?void 0:c.call(i);return this.code?$("code",{class:l,style:this.cssVars},this.delete?$("del",null,n):n):this.delete?$("del",{class:l,style:this.cssVars},n):$(this.compitableTag||"span",{class:l,style:this.cssVars},n)}}),et=async(o,i,c)=>{var d,m;const r=ke("token",null).value;if(!r)throw Error("no token");const{data:l,error:n}=await ae("/form/all",{baseURL:"https://124.223.35.239/api/v1",headers:{authorization:`Bearer ${r}`},params:{page:o,page_long:i,sort:c}},"$3FbuzmXuuA");if(!n.value)return l;throw n.value.statusCode===500?Error("服务端错误，请联系网站管理员"):Error(((d=n.value.data)==null?void 0:d.message)??n.value.message??((m=n.value.data)==null?void 0:m.code))},tt=async(o,i)=>{var l,n;const{data:c,error:r}=await ae("/form/like",{baseURL:"https://124.223.35.239/api/v1",method:"post",params:{captoken:i,name:o}},"$Dalx9gXCTf");if(!r.value)return c;throw r.value.statusCode===500?Error("服务端错误，请联系网站管理员"):Error(((l=r.value.data)==null?void 0:l.message)??r.value.message??((n=r.value.data)==null?void 0:n.code))},ot={key:0,"my-4":"","max-w-1080px":"","w-90vw":"",flex:"","flex-col":"","items-center":"","gap-2":""},nt={key:1,"w-full":""},rt={"w-full":"","text-end":""},at=f("div",{"i-material-symbols-sort":"","text-xl":""},null,-1),st={flex:"","flex-wrap":"","justify-center":"","gap-2":""},lt={flex:"","items-center":"","gap-4":""},it={flex:"","flex-col":""},ct={"text-xl":"","font-bold":""},dt={"text-slate-500":""},ut={flex:"","items-center":"","justify-between":""},ft={flex:""},mt=f("div",null,"得票数：",-1),vt={"font-bold":""},ht={flex:"","flex-wrap":"","gap-4":"","text-lg":""},_t={flex:"","flex-wrap":"","gap-4":"","text-lg":""},Z=1,ne=6,Ot=ee({__name:"vote",setup(o){_e({title:"全部队伍 丨 ASG 第五人格赛事"});const i=pe([]),c=p(!0),r=p(Z),l=Ce(),n=p(!1),d=p(null),{me:m}=ye(),u=p(!0),w=p(null),S=Re(),v=p("vote"),g=async()=>{try{const e=await et(r.value,ne,v.value);return i.push(...e.value.map(s=>({logo:s.logo_uri,members:s.rolename.map(a=>({camp:a.lin==="求生者",name:a.name})),name:s.name,time:new Date(s.timer).toLocaleString(),vote:s.piaoshu}))),c.value=!1,e}catch(e){e instanceof Error&&l.error(e.message)}return p([])},E=async()=>{c.value=!0,r.value++,(await g()).value.length===0&&l.info("没有更多数据了")};re(m,async()=>{r.value=Z,m.value&&(await g(),u.value=!1)},{immediate:!0});const z=e=>{w.value=e,n.value=!0},F=async e=>{const s=w.value;if(s){try{s.vote=(await tt(s.name,e)).value.number,l.success("投票成功")}catch(a){a instanceof Error&&l.error(a.message)}n.value=!1}},k=()=>{var e;(e=d.value)==null||e.reset()},I=()=>{var e;l.info("验证失败"),(e=d.value)==null||e.reset()},N=e=>{Se()},t=async()=>{v.value=v.value==="time"?"vote":"time",u.value=!0,r.value=Z,i.splice(0),await g(),u.value=!1};return(e,s)=>{const a=We,h=De,L=Ne,P=qe,T=Fe,A=Ge,D=Qe,K=Ee,M=Ae,ce=fe,de=Be,ue=Ue;return b(m)?(y(),H("div",ot,[b(i).length===0&&!b(u)?(y(),B(a,{key:0,description:"暂时没有队伍报名"})):G("",!0),b(u)?(y(),H("div",nt,[x(h,{text:"",repeat:4}),x(h,{text:"",style:{width:"60%"}})])):G("",!0),f("div",rt,[x(L,{text:"",onClick:t},{default:_(()=>[f("div",null,V(b(v)==="time"?"时间":"票数")+"排序",1),at]),_:1})]),f("div",st,[(y(!0),H(X,null,J(b(i),C=>(y(),B(K,{key:C.name,"max-w-350px":""},{default:_(()=>[f("div",lt,[x(P,{size:84,src:C.logo||"#","fallback-src":"~/assets/carousel-logo.webp","flex-none":"",color:"transparent"},null,8,["src"]),f("div",it,[f("div",ct,V(C.name),1),f("div",dt," 报名时间："+V(C.time),1),f("div",ut,[x(T,{bordered:!1},{default:_(()=>[f("div",ft,[mt,f("div",vt,V(C.vote),1)])]),_:2},1024),x(L,{size:"small",type:"primary","text-white":"",onClick:R=>z(C)},{default:_(()=>[O(" 投票 ")]),_:2},1032,["onClick"])])])]),x(A,null,{default:_(()=>[x(T,{type:"info",bordered:!1},{default:_(()=>[O(" 求生者 ")]),_:1})]),_:1}),f("div",ht,[(y(!0),H(X,null,J(C.members.filter(R=>R.camp),R=>(y(),B(D,{key:R.name,type:"info"},{default:_(()=>[O(V(R.name),1)]),_:2},1024))),128))]),x(A,null,{default:_(()=>[x(T,{type:"error",bordered:!1},{default:_(()=>[O(" 监管者 ")]),_:1})]),_:1}),f("div",_t,[(y(!0),H(X,null,J(C.members.filter(R=>!R.camp),R=>(y(),B(D,{key:R.name,type:"error"},{default:_(()=>[O(V(R.name),1)]),_:2},1024))),128))])]),_:2},1024))),128))]),b(u)?G("",!0):(y(),B(M,{key:2,show:b(c),size:"small"},{default:_(()=>[b(i).length%ne===0?(y(),B(L,{key:0,tertiary:"",type:"primary",onClick:E},{default:_(()=>[O(" 查看更多 ")]),_:1})):G("",!0)]),_:1},8,["show"])),x(de,{show:b(n),"onUpdate:show":s[0]||(s[0]=C=>ge(n)?n.value=C:null),"mask-closable":!1,"max-w-350px":"",preset:"card"},{default:_(()=>[be(x(ce,{ref_key:"reCaptchaRef",ref:d,theme:b(S)?"dark":"light",onVerify:F,onExpire:k,onFail:I,onError:N},null,8,["theme"]),[[xe,b(n)]])]),_:1},8,["show"])])):(y(),B(ue,{key:1,status:"warning",title:"未登录",description:"在查看全部战队信息前请先登录",style:{"min-height":"calc(100vh - 50px - 60px)"},flex:"","flex-col":"","justify-center":"",size:"huge"}))}}});export{Ot as default};
