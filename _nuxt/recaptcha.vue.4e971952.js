import{o as g}from"./ready.7dc32f0b.js";import{f as y,r as k,o as _,c as b}from"./entry.072bc2c9.js";const v=y({__name:"recaptcha",props:{sitekey:{type:String,required:!1,default:"6LcdXUEmAAAAACHoMlbHRilEp6pTwoMctq-8P0g9"},size:{type:String,required:!1,default:"normal"},theme:{type:String,required:!1,default:"light"},hl:{type:String,required:!1,default:"zh-CN"},loadingTimeout:{type:Number,required:!1,default:3e4}},emits:{verify:r=>r!=null&&r!="",error:r=>{}},setup(r,{expose:m,emit:l}){const e=r,d=k(null);let a=null;m({execute:function(){window.grecaptcha.execute(a)},reset:function(){window.grecaptcha.reset(a)}});function s(){a=window.grecaptcha.render(d.value,{sitekey:e.sitekey,theme:e.theme,size:e.size,callback:t=>l("verify",t),"expired-callback":()=>window.grecaptcha.reset(a),"error-callback":()=>window.grecaptcha.reset(a)})}return g(()=>{window.grecaptcha==null?new Promise((t,u)=>{let o,n=!1;window.recaptchaReady=function(){n||(n=!0,clearTimeout(o),t())};const p="recaptcha-script",i=w=>()=>{var h;n||(n=!0,clearTimeout(o),(h=document.getElementById(p))==null||h.remove(),u(w))};e.loadingTimeout>0&&(o=setTimeout(i("timeout"),e.loadingTimeout));const f=window.document,c=f.createElement("script");c.id=p,c.onerror=i("error"),c.onabort=i("aborted"),c.setAttribute("src",`https://www.recaptcha.net/recaptcha/api.js?onload=recaptchaReady&render=explicit&hl=${e.hl}&_=${+new Date}`),f.head.appendChild(c)}).then(()=>{s()}).catch(t=>{l("error",t)}):s()}),(t,u)=>(_(),b("div",{ref_key:"recaptchaDiv",ref:d},null,512))}});export{v as _};
