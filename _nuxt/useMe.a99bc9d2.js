import{U as n}from"./entry.ae86df47.js";import{c as t,u}from"./index.42eaed54.js";import{u as l}from"./Spin.2341e5d4.js";const x={closeIconSizeTiny:"12px",closeIconSizeSmall:"12px",closeIconSizeMedium:"14px",closeIconSizeLarge:"14px",closeSizeTiny:"16px",closeSizeSmall:"16px",closeSizeMedium:"18px",closeSizeLarge:"18px",padding:"0 7px",closeMargin:"0 0 0 4px",closeMarginRtl:"0 4px 0 0"},c=()=>{t("token",null).value=null;const{destroy:e}=p();e()},i=async()=>{var o,a;const e=t("token",null).value;if(!e)throw Error("no token");const{data:s,error:r}=await u("/user",{baseURL:"https://124.223.35.239/api/v1",headers:{authorization:`Bearer ${e}`}},"$ctCRYusCin");if(!r.value)return s;throw r.value.statusCode===401?(c(),Error("token expired")):Error(((o=r.value.data)==null?void 0:o.message)??r.value.message??((a=r.value.data)==null?void 0:a.code))},p=()=>{const e=n("me",()=>null),s=l();return{destroy(){e.value=null},me:e,update:async()=>{try{e.value=(await i()).value}catch(o){if(!(o instanceof Error))throw o;if(o.message==="no token")return null;if(o.message==="token expired")return s.warning("登录过期，请重新登录"),null;throw Error(o.message)}return e}}};export{c as a,x as c,p as u};
