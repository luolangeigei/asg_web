import{_ as re,a as ae}from"./recaptcha.vue.05d2b3c2.js";import{f as ee,r as f,k as J,h as O,y as te,m as se,B as le,i as ie,j as P,u as ce,E as de,G as x,c as L,b as R,J as G,a as p,F as D,K as U,g as I,w as F,I as ue,o as _,t as V,d as M,z as fe,v as me}from"./entry.48ff73e6.js";import{u as ve}from"./useMe.2e7bfa4d.js";import{V as he,c as _e,u as oe,b as pe,_ as ge}from"./index.88941516.js";import{u as be,_ as xe,a as W}from"./useUnknownError.553df642.js";import{a as ye,_ as we}from"./Modal.57d5c2b9.js";import{i as K,o as ze}from"./utils.82fec44a.js";import{t as ke}from"./Tag.6463d40d.js";import{c as Re,g as Y,F as Ee,f as X,G as Ce,q as Z,u as Le,b as ne,m as Fe,j as Se,H as je,n as $e,D as Te,_ as Be}from"./Button.baccfbf4.js";import{_ as Oe}from"./Divider.df53ae62.js";import{_ as Pe}from"./Result.941625b2.js";import"./ready.b8dd0555.js";import"./index.cd32510b.js";import"./asyncData.d23467b1.js";import"./light.3a2ceb11.js";const Ve=Re("n-avatar-group"),He=Y("avatar",`
 width: var(--n-merged-size);
 height: var(--n-merged-size);
 color: #FFF;
 font-size: var(--n-font-size);
 display: inline-flex;
 position: relative;
 overflow: hidden;
 text-align: center;
 border: var(--n-border);
 border-radius: var(--n-border-radius);
 --n-merged-color: var(--n-color);
 background-color: var(--n-merged-color);
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[Ee(X("&","--n-merged-color: var(--n-color-modal);")),Ce(X("&","--n-merged-color: var(--n-color-popover);")),X("img",`
 width: 100%;
 height: 100%;
 `),Z("text",`
 white-space: nowrap;
 display: inline-block;
 position: absolute;
 left: 50%;
 top: 50%;
 `),Y("icon",`
 vertical-align: bottom;
 font-size: calc(var(--n-merged-size) - 6px);
 `),Z("text","line-height: 1.25")]),Ie=Object.assign(Object.assign({},ne.props),{size:[String,Number],src:String,circle:{type:Boolean,default:void 0},objectFit:String,round:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},onError:Function,fallbackSrc:String,intersectionObserverOptions:Object,lazy:Boolean,onLoad:Function,renderPlaceholder:Function,renderFallback:Function,imgProps:Object,color:String}),Me=ee({name:"Avatar",props:Ie,setup(n){const{mergedClsPrefixRef:c,inlineThemeDisabled:d}=Le(n),a=f(!1);let i=null;const m=f(null),h=f(null),E=()=>{const{value:e}=m;if(e&&(i===null||i!==e.innerHTML)){i=e.innerHTML;const{value:t}=h;if(t){const{offsetWidth:r,offsetHeight:o}=t,{offsetWidth:l,offsetHeight:T}=e,j=.9,B=Math.min(r/l*j,o/T*j,1);e.style.transform=`translateX(-50%) translateY(-50%) scale(${B})`}}},g=J(Ve,null),y=O(()=>{const{size:e}=n;if(e)return e;const{size:t}=g||{};return t||"medium"}),S=ne("Avatar","-avatar",He,ye,n,c),b=J(ke,null),w=O(()=>{if(g)return!0;const{round:e,circle:t}=n;return e!==void 0||t!==void 0?e||t:b?b.roundRef.value:!1}),C=O(()=>g?!0:n.bordered||!1),z=e=>{var t;if(!$.value)return;a.value=!0;const{onError:r,imgProps:o}=n;(t=o==null?void 0:o.onError)===null||t===void 0||t.call(o,e),r&&r(e)};te(()=>n.src,()=>a.value=!1);const H=O(()=>{const e=y.value,t=w.value,r=C.value,{color:o}=n,{self:{borderRadius:l,fontSize:T,color:j,border:B,colorModal:N,colorPopover:A},common:{cubicBezierEaseInOut:v}}=S.value;let u;return typeof e=="number"?u=`${e}px`:u=S.value.self[Fe("height",e)],{"--n-font-size":T,"--n-border":r?B:"none","--n-border-radius":t?"50%":l,"--n-color":o||j,"--n-color-modal":o||N,"--n-color-popover":o||A,"--n-bezier":v,"--n-merged-size":`var(--n-avatar-size-override, ${u})`}}),k=d?Se("avatar",O(()=>{const e=y.value,t=w.value,r=C.value,{color:o}=n;let l="";return e&&(typeof e=="number"?l+=`a${e}`:l+=e[0]),t&&(l+="b"),r&&(l+="c"),o&&(l+=je(o)),l}),H,n):void 0,$=f(!n.lazy);se(()=>{if(K)return;let e;const t=le(()=>{e==null||e(),e=void 0,n.lazy&&(e=ze(h.value,n.intersectionObserverOptions,$))});ie(()=>{t(),e==null||e()})});const s=f(!n.lazy);return{textRef:m,selfRef:h,mergedRoundRef:w,mergedClsPrefix:c,fitTextTransform:E,cssVars:d?void 0:H,themeClass:k==null?void 0:k.themeClass,onRender:k==null?void 0:k.onRender,hasLoadError:a,handleError:z,shouldStartLoading:$,loaded:s,mergedOnLoad:e=>{var t;const{onLoad:r,imgProps:o}=n;r==null||r(e),(t=o==null?void 0:o.onLoad)===null||t===void 0||t.call(o,e),s.value=!0}}},render(){var n,c;const{$slots:d,src:a,mergedClsPrefix:i,lazy:m,onRender:h,mergedOnLoad:E,shouldStartLoading:g,loaded:y,hasLoadError:S}=this;h==null||h();let b;const w=!y&&!S&&(this.renderPlaceholder?this.renderPlaceholder():(c=(n=this.$slots).placeholder)===null||c===void 0?void 0:c.call(n));return this.hasLoadError?b=this.renderFallback?this.renderFallback():$e(d.fallback,()=>[P("img",{src:this.fallbackSrc,style:{objectFit:this.objectFit}})]):b=Te(d.default,C=>{if(C)return P(he,{onResize:this.fitTextTransform},{default:()=>P("span",{ref:"textRef",class:`${i}-avatar__text`},C)});if(a){const{imgProps:z}=this;return P("img",Object.assign(Object.assign({},z),{loading:K&&!this.intersectionObserverOptions&&m?"lazy":"eager",src:K||g||y?a:void 0,onLoad:E,"data-image-src":a,onError:this.handleError,style:[z==null?void 0:z.style,{objectFit:this.objectFit},w?{height:"0",width:"0",visibility:"hidden",position:"absolute"}:""]}))}}),P("span",{ref:"selfRef",class:[`${i}-avatar`,this.themeClass],style:this.cssVars},b,m&&w)}}),Ne=async(n,c)=>{const d=_e("token",null).value;if(!d)throw Error("no token");const{data:a,error:i}=await oe("/form/all",{baseURL:"https://124.223.35.239/api/v1",headers:{authorization:`Bearer ${d}`},params:{page:n,page_long:c}},"$3FbuzmXuuA");if(i.value)throw i;return a},Ae=async(n,c)=>{const{data:d,error:a}=await oe("/form/like",{baseURL:"https://124.223.35.239/api/v1",method:"post",params:{captoken:c,name:n}},"$Dalx9gXCTf");if(a.value)throw a;return d},Ge={key:0,"my-4":"","max-w-1080px":"","w-90vw":"",flex:"","flex-col":"","items-center":"","gap-4":""},De={key:0,"w-full":""},Ue={flex:"","flex-wrap":"","justify-center":"","gap-3":""},We={flex:"","items-center":"","gap-4":""},Ke={flex:"","flex-col":""},Xe={"text-xl":"","font-bold":""},qe={"text-slate-500":""},Je={flex:"","items-center":"","justify-between":""},Ye={flex:"","text-slate-500":""},Ze=p("div",null,"得票数：",-1),Qe={"font-bold":""},et={flex:"","flex-wrap":"","gap-4":"",color:"#2A3990","text-lg":""},tt={flex:"","flex-wrap":"","gap-4":"",color:"#9C254D","text-lg":""},Q=1,q=6,pt=ee({__name:"vote",setup(n){ce({title:"全部队伍 丨 ASG 第五人格赛事"});const c=de([]),d=f(!0),a=f(Q),i=be(),m=f(!1),h=f(null),{me:E}=ve(),g=f(!0),y=f(null),S=pe(),b=async(s,e)=>{var t;try{const r=await Ne(s,e);return c.push(...r.value.map(o=>({logo:o.logo_uri,members:o.rolename.map(l=>({camp:l.lin==="求生者",name:l.name})),name:o.name,time:new Date(o.timer).toLocaleString(),vote:o.piaoshu}))),d.value=!1,r}catch(r){if((t=r.value.data)!=null&&t.message)return i.error(r.value.data.message),f([]);W()}return f([])},w=async()=>{d.value=!0,(await b(++a.value,q)).value.length===0&&i.info("没有更多数据了")};te(E,async()=>{a.value=Q,E.value&&(await b(a.value,q),g.value=!1)},{immediate:!0});const C=s=>{y.value=s,m.value=!0},z=async s=>{var t;const e=y.value;if(e){try{e.vote=(await Ae(e.name,s)).value.number,i.success("投票成功")}catch(r){(t=r.value.data)!=null&&t.message?i.error(r.value.data.message):W()}m.value=!1}},H=()=>{var s;(s=h.value)==null||s.reset()},k=()=>{var s;i.info("验证失败"),(s=h.value)==null||s.reset()},$=s=>{W()};return(s,e)=>{const t=re,r=Me,o=Be,l=Oe,T=ge,j=xe,B=ae,N=we,A=Pe;return x(E)?(_(),L("div",Ge,[x(g)?(_(),L("div",De,[R(t,{text:"",repeat:2}),R(t,{text:"",style:{width:"60%"}})])):G("",!0),p("div",Ue,[(_(!0),L(D,null,U(x(c),v=>(_(),I(T,{key:v.name,"max-w-350px":""},{default:F(()=>[p("div",We,[R(r,{size:84,src:v.logo||"#","fallback-src":"/assets/carousel-logo.webp","flex-none":"",color:"transparent"},null,8,["src"]),p("div",Ke,[p("div",Xe,V(v.name),1),p("div",qe," 报名时间："+V(v.time),1),p("div",Je,[p("div",Ye,[Ze,p("div",Qe,V(v.vote),1)]),R(o,{size:"small",type:"primary",onClick:u=>C(v)},{default:F(()=>[M(" 投票 ")]),_:2},1032,["onClick"])])])]),R(l,{color:"#2A3990"},{default:F(()=>[M(" 求生者 ")]),_:1}),p("div",et,[(_(!0),L(D,null,U(v.members.filter(u=>u.camp),u=>(_(),L("div",{key:u.name,"text-lg":""},V(u.name),1))),128))]),R(l,{color:"#9C254D"},{default:F(()=>[M(" 监管者 ")]),_:1}),p("div",tt,[(_(!0),L(D,null,U(v.members.filter(u=>!u.camp),u=>(_(),L("div",{key:u.name,"text-lg":""},V(u.name),1))),128))])]),_:2},1024))),128))]),x(g)?G("",!0):(_(),I(j,{key:1,show:x(d),size:"small"},{default:F(()=>[x(c).length===q?(_(),I(o,{key:0,text:"",type:"primary",size:"large",onClick:w},{default:F(()=>[M(" 查看更多 ")]),_:1})):G("",!0)]),_:1},8,["show"])),R(N,{show:x(m),"onUpdate:show":e[0]||(e[0]=v=>ue(m)?m.value=v:null),"mask-closable":!1,"max-w-350px":"",preset:"card"},{default:F(()=>[fe(R(B,{ref_key:"reCaptchaRef",ref:h,theme:x(S)?"dark":"light",onVerify:z,onExpire:H,onFail:k,onError:$},null,8,["theme"]),[[me,x(m)]])]),_:1},8,["show"])])):(_(),I(A,{key:1,status:"warning",title:"未登录",description:"在查看全部战队信息前请先登录",style:{"min-height":"calc(100vh - 50px - 60px)"},flex:"","flex-col":"","justify-center":"",size:"huge"}))}}});export{pt as default};
